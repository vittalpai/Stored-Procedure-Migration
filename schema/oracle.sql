--------------------------------------------------------
--  DDL for Table CUSTOMER
--------------------------------------------------------

  CREATE TABLE "VITTAL"."CUSTOMER" 
   (	"ID" NUMBER(*,0), 
	"NAME" VARCHAR2(255 BYTE), 
	"OCCUPATION" VARCHAR2(255 BYTE), 
	"ZIPCODE" VARCHAR2(10 BYTE), 
	"PHONENUMBER" VARCHAR2(15 BYTE), 
	"CONSENT" CHAR(1 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
REM INSERTING into VITTAL.CUSTOMER
SET DEFINE OFF;
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (1,'Rajesh Kumar','Engineer','10291','9876543210','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (2,'Aishwarya Singh','Doctor','10231','9876543211','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (3,'Ramesh Sharma','Business','10232','9876543212','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (4,'Sneha Gupta','Business','12031','9876543213','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (5,'Amit Patel','Engineer','10291','9876543214','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (6,'Neha Verma','Engineer','10231','9876543215','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (7,'Sanjay Kumar','Doctor','10232','9876543216','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (8,'Anita Sharma','Business','12031','9876543217','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (9,'Vikram Singh','Engineer','10291','9876543218','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (10,'Sneha Gupta','Doctor','10231','9876543219','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (11,'Vivek Sharma','Engineer','10291','9876543220','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (12,'Pooja Verma','Doctor','10231','9876543221','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (13,'Amit Kumar','Business','10232','9876543222','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (14,'Kavita Singh','Business','12031','9876543223','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (15,'Nikhil Patel','Engineer','10291','9876543224','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (16,'Sneha Verma','Engineer','10231','9876543225','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (17,'Rahul Kumar','Doctor','10232','9876543226','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (18,'Anjali Sharma','Business','12031','9876543227','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (19,'Ravi Singh','Engineer','10291','9876543228','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (20,'Sneha Gupta','Doctor','10231','9876543229','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (21,'Amit Sharma','Engineer','10291','9876543230','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (22,'Preeti Singh','Doctor','10231','9876543231','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (23,'Rahul Kumar','Business','10232','9876543232','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (24,'Neeta Verma','Business','12031','9876543233','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (25,'Sneha Patel','Engineer','10291','9876543234','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (26,'Alok Verma','Engineer','10231','9876543235','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (27,'Sanjay Singh','Doctor','10232','9876543236','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (28,'Anjali Sharma','Business','12031','9876543237','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (29,'Neha Singh','Engineer','10291','9876543238','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (30,'Sneha Gupta','Doctor','10231','9876543239','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (31,'Vivek Sharma','Engineer','10291','9876543240','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (32,'Pooja Verma','Doctor','10231','9876543241','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (33,'Amit Kumar','Business','10232','9876543242','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (34,'Kavita Singh','Business','12031','9876543243','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (35,'Nikhil Patel','Engineer','10291','9876543244','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (36,'Sneha Verma','Engineer','10231','9876543245','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (37,'Rahul Kumar','Doctor','10232','9876543246','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (38,'Anjali Sharma','Business','12031','9876543247','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (39,'Ravi Singh','Engineer','10291','9876543248','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (40,'Sneha Gupta','Doctor','10231','9876543249','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (41,'Amit Sharma','Engineer','10291','9876543250','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (42,'Preeti Singh','Doctor','10231','9876543251','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (43,'Rahul Kumar','Business','10232','9876543252','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (44,'Neeta Verma','Business','12031','9876543253','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (45,'Sneha Patel','Engineer','10291','9876543254','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (46,'Alok Verma','Engineer','10231','9876543255','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (47,'Sanjay Singh','Doctor','10232','9876543256','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (48,'Anjali Sharma','Business','12031','9876543257','Y');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (49,'Neha Singh','Engineer','10291','9876543258','N');
Insert into VITTAL.CUSTOMER (ID,NAME,OCCUPATION,ZIPCODE,PHONENUMBER,CONSENT) values (50,'Sneha Gupta','Doctor','10231','9876543259','Y');
--------------------------------------------------------
--  DDL for Index SYS_C0012734
--------------------------------------------------------

  CREATE UNIQUE INDEX "VITTAL"."SYS_C0012734" ON "VITTAL"."CUSTOMER" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index IDX_CUSTOMER_ZIPCODE
--------------------------------------------------------

  CREATE INDEX "VITTAL"."IDX_CUSTOMER_ZIPCODE" ON "VITTAL"."CUSTOMER" ("ZIPCODE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index IDX_CUSTOMER_OCCUPATION
--------------------------------------------------------

  CREATE INDEX "VITTAL"."IDX_CUSTOMER_OCCUPATION" ON "VITTAL"."CUSTOMER" ("OCCUPATION") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  Constraints for Table CUSTOMER
--------------------------------------------------------

  ALTER TABLE "VITTAL"."CUSTOMER" ADD PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;


--------------------------------------------------------
--  DDL for Table CUSTOMERTRANSACTIONSUMMARY
--------------------------------------------------------

  CREATE TABLE "VITTAL"."CUSTOMERTRANSACTIONSUMMARY" 
   (	"ID" NUMBER(*,0), 
	"CUSTOMERID" NUMBER(*,0), 
	"ACCOUNTTYPE" VARCHAR2(2 BYTE), 
	"CARDNUMBER" VARCHAR2(16 BYTE), 
	"BALANCE" NUMBER(10,2)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
REM INSERTING into VITTAL.CUSTOMERTRANSACTIONSUMMARY
SET DEFINE OFF;
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (1,1,'CC','4921828601681341',23233);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (2,2,'SV','492182861611320',41231);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (3,3,'CC','4921828607123456',18942);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (4,4,'SV','4921828618234567',9800);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (5,5,'CC','4921828609345678',15000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (6,6,'SV','4921828610456789',8000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (7,7,'CC','4921828611567890',27500);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (8,8,'SV','4921828612678901',4120);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (9,9,'CC','4921828613789012',14500);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (10,10,'SV','4921828614890123',6720);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (11,11,'CC','4921828601111341',12000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (12,12,'SV','492182861411320',67000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (13,13,'CC','4921828606123456',3200);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (14,14,'SV','4921828617234567',800);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (15,15,'CC','4921828608345678',9500);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (16,16,'SV','4921828619456789',11200);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (17,17,'CC','4921828620567890',17500);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (18,18,'SV','4921828621678901',2430);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (19,19,'CC','4921828622789012',8900);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (20,20,'SV','4921828623890123',6700);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (21,21,'CC','4921828602111341',10000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (22,22,'SV','492182861511320',45000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (23,23,'CC','4921828604123456',6000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (24,24,'SV','4921828616234567',2300);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (25,25,'CC','4921828608345678',7500);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (26,26,'SV','4921828619456789',8900);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (27,27,'CC','4921828620567890',12000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (28,28,'SV','4921828621678901',3100);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (29,29,'CC','4921828622789012',5700);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (30,30,'SV','4921828623890123',4200);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (31,31,'CC','4921828604111341',9900);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (32,32,'SV','492182861611320',60000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (33,33,'CC','4921828609123456',7500);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (34,34,'SV','4921828619234567',1200);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (35,35,'CC','4921828608345678',8700);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (36,36,'SV','4921828619456789',9400);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (37,37,'CC','4921828620567890',15600);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (38,38,'SV','4921828621678901',3400);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (39,39,'CC','4921828622789012',6200);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (40,40,'SV','4921828623890123',4700);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (41,41,'CC','4921828604111341',7000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (42,42,'SV','492182861711320',54000);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (43,43,'CC','4921828604123456',3500);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (44,44,'SV','4921828617234567',1600);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (45,45,'CC','4921828608345678',6800);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (46,46,'SV','4921828619456789',7200);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (47,47,'CC','4921828620567890',14300);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (48,48,'SV','4921828621678901',2600);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (49,49,'CC','4921828622789012',6100);
Insert into VITTAL.CUSTOMERTRANSACTIONSUMMARY (ID,CUSTOMERID,ACCOUNTTYPE,CARDNUMBER,BALANCE) values (50,50,'SV','4921828623890123',4600);
--------------------------------------------------------
--  DDL for Index SYS_C0012735
--------------------------------------------------------

  CREATE UNIQUE INDEX "VITTAL"."SYS_C0012735" ON "VITTAL"."CUSTOMERTRANSACTIONSUMMARY" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index IDX_TRANSACTIONSUMMARY
--------------------------------------------------------

  CREATE INDEX "VITTAL"."IDX_TRANSACTIONSUMMARY" ON "VITTAL"."CUSTOMERTRANSACTIONSUMMARY" ("CUSTOMERID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  Constraints for Table CUSTOMERTRANSACTIONSUMMARY
--------------------------------------------------------

  ALTER TABLE "VITTAL"."CUSTOMERTRANSACTIONSUMMARY" ADD PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table CUSTOMERTRANSACTIONSUMMARY
--------------------------------------------------------

  ALTER TABLE "VITTAL"."CUSTOMERTRANSACTIONSUMMARY" ADD FOREIGN KEY ("CUSTOMERID")
	  REFERENCES "VITTAL"."CUSTOMER" ("ID") ENABLE;

--------------------------------------------------------
--  DDL for Procedure TOPCUSTOMERS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "VITTAL"."TOPCUSTOMERS" (
  ZIPCODE IN  VARCHAR2,
  OCCUPATION IN  VARCHAR2,
  RES    OUT SYS_REFCURSOR )
AS
 stmt VARCHAR2(2000);
BEGIN
  stmt := 'SELECT C.ID, C.NAME, C.PHONENUMBER, LPAD(SUBSTR (T.CARDNUMBER, 13, 4), 16, ''X'') AS MASKEDCARDNUMBER FROM CUSTOMER C INNER JOIN CUSTOMERTRANSACTIONSUMMARY T ON C.ID = T.CustomerID';

   IF ZIPCODE IS NOT NULL AND OCCUPATION IS NOT NULL THEN 
       stmt := stmt || ' WHERE ' || 'C.ZipCode=' || CHR (39) || ZIPCODE || CHR (39) || ' AND C.Occupation=' || CHR (39) || OCCUPATION || CHR (39) ;
  END IF;
  stmt := stmt || ' ORDER BY T.BALANCE DESC FETCH FIRST 10 ROWS ONLY';  

  OPEN RES FOR stmt;

  EXCEPTION
        WHEN OTHERS THEN
            dbms_output.put_line(SQLERRM);

END TOPCUSTOMERS;

/
